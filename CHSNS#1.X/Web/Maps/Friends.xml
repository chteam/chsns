<?xml version="1.0" encoding="UTF-8" ?>
<sqlMap xmlns="http://ibatis.apache.org/mapping"
		namespace="Friends"
			    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" >
  <alias>
    <typeAlias alias="Friend" type="CHSNS.Model.FriendImplement,CHSNS.Model" />
  </alias>
  
  <resultMaps>
    
  </resultMaps>
  <statements>
<select id="FriendsId" parameterClass="long" resultClass="long">
      select ToId as value from [Friend] where FromId=#value# and IsTrue=1
      union
      select FromId as value from [Friend] where toid=#value# and istrue=1
    </select>
    <select id="GetFriendsCount" parameterClass="long" resultClass="int">
      select count(1) as c from(
      select ToId as x from [Friend] where FromId=#value# and IsTrue=1
      union
      select FromId as x from [Friend] where toid=#value# and istrue=1
      )a
    </select>
 <select id="GetFriendsPaged" parameterClass ="System.Collections.IDictionary" resultClass="Profile">
   SELECT UserId,Name
   FROM       (
   SELECT UserId,Name,
   ROW_NUMBER() OVER (order by [userid])as RowNumber
   FROM [Profile]
   WHERE UserId in (
   select ToId as value from [Friend] where FromId=#UserId# and IsTrue=1
   union
   select FromId as value from [Friend] where toid=#UserId# and istrue=1
   ))OrderedOrders
   WHERE RowNumber between #Begin# and #End#
 </select>   
  </statements>
</sqlMap>